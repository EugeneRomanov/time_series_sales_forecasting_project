# Прогнозирование временных рядов продаж

Данный проект реализует различные подходы к прогнозированию временных рядов продаж в розничной торговле с использованием как классических статистических моделей, так и современных методов машинного обучения.

## Структура проекта

```
time_series_forecasting/
├── data/                      # Директория с исходными данными
├── models/                    # Сохраненные предобученные модели CatBoost
├── src/                       # Исходный код
│   ├── forecasters/           # Реализации прогнозирующих классов
│   │   ├── __init__.py
│   │   ├── classical_forecaster.py  # Классические модели (ARIMA, SARIMA, ETS)
│   │   ├── modern_forecaster.py     # Современные модели (CatBoost)
│   │   └── best_forecaster.py       # Итоговая имплементация лучших моделей (CatBoost)
├── classical_models_forecasting.ipynb  # Отчет по классическим моделям
├── catboost_forecasting.ipynb          # Отчет по современным моделям
├── inference_forecasting.ipynb         # Демонстрация инференса предобученных моделей
├── README.md                           # описание проекта
└── requirements.txt                    # Зависимости проекта
```

## Задания проекта

### 1. Прогнозирование с помощью классических методов (`classical_models_forecasting.ipynb`)

В рамках первого задания реализован класс `ClassicalForecaster`, который:
- Выполняет предобработку исходных данных в формат, удобный для анализа временных рядов
- Реализует обучение и прогнозирование с помощью классических статистических моделей:
  - ARIMA (AutoRegressive Integrated Moving Average)
  - SARIMA (Seasonal ARIMA)
  - ETS (Error, Trend, Seasonality / Exponential Smoothing)
- Оценивает качество прогнозов с использованием метрик MAE, RMSE, MAPE, R²
- Визуализирует результаты прогнозирования для различных горизонтов (неделя, месяц, квартал)
- Предоставляет функционал автоматического поиска оптимальной модели для каждого временного ряда

### 2. Прогнозирование с помощью современных методов (`catboost_forecasting.ipynb`)

Во втором задании реализован класс `ModernForecaster`, который:
- Предобрабатывает данные с учетом специфики методов машинного обучения
- Реализует прогнозирование с использованием градиентного бустинга (CatBoost)
- Выполняет подбор гиперпараметров для оптимизации качества прогнозов
- Сравнивает качество прогнозов на различных временных горизонтах
- Визуализирует результаты и значимость признаков

### 3. Итоговый проект - инференс предобученных моделей (`inference_forecasting.ipynb`)

В итоговом проекте реализован класс `BestForecaster`, который:
- Интегрирует лучшие модели из предыдущих заданий
- Предоставляет функционал загрузки предобученных моделей из директории models/
- Выполняет инференс (прогнозирование) на произвольных данных без переобучения
- Обеспечивает прогнозирование на неделю, месяц и квартал
- Визуализирует результаты и оценивает качество прогнозов

## Используемые данные

Проект работает с данными о продажах товаров в розничных магазинах, включая:
- Временные ряды продаж по товарам (количество продаж, выручка)
- Информацию о ценах
- Календарные данные с информацией о событиях и акциях

## Зависимости проекта

Для установки необходимых зависимостей используйте:
```
pip install -r requirements.txt
```

## Результаты

Подробные результаты анализа, сравнения моделей и визуализации представлены в соответствующих Jupyter-ноутбуках:
- `classical_models_forecasting.ipynb` - Анализ и сравнение классических моделей
- `catboost_forecasting.ipynb` - Анализ и результаты современных методов
- `inference_forecasting.ipynb` - Демонстрация инференса лучших моделей

## Автор

Eugene Romanov
tg@wallrich
